
Функция ПолучитьВыборку(МассивСсылок)

    Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |   РаспределениеПрочихЗатрат.Дата,
    |   РаспределениеПрочихЗатрат.Номер,
    |   РаспределениеПрочихЗатрат.Организация,
    |   РаспределениеПрочихЗатрат.Ссылка КАК Ссылка,
    |   РаспределениеПрочихЗатрат.СхемаРаспределения,
    |   РаспределениеПрочихЗатрат.СхемаРаспределения.СчетЗатрат,
    |// первая ТЧ
    |   РаспределениеПрочихЗатрат.СуммыКРаспределению.(
    |       Субконто1,
    |       Субконто2,
    |       Субконто3,
    |       СУММА(Сумма),
    |       СчетЗатрат
    |   ),
    |// вторая ТЧ
    |   РаспределениеПрочихЗатрат.ЗатратыНаПродукцию.(
    |       Спецификация,
    |       СтатьяЗатрат,
    |       СУММА(Сумма),
    |       СчетЗатрат
    |   )
    |ИЗ
    |   Документ.РаспределениеПрочихЗатрат КАК РаспределениеПрочихЗатрат
    |ГДЕ
    |   РаспределениеПрочихЗатрат.Ссылка В(&Массивссылок)
    |
    |СГРУППИРОВАТЬ ПО
    |   РаспределениеПрочихЗатрат.СуммыКРаспределению.(СчетЗатрат,
    |   Субконто1,
    |   Субконто2,
    |   Субконто3),
    |   РаспределениеПрочихЗатрат.ЗатратыНаПродукцию.(Спецификация,
    |   СтатьяЗатрат,
    |   СчетЗатрат)
    |ИТОГИ ПО
    |   ОБЩИЕ,
    |   Ссылка";
    Запрос.УстановитьПараметр("Массивссылок", Массивссылок);
    Выборка = Запрос.Выполнить().Выбрать();
    
    Возврат Выборка;

КонецФункции
